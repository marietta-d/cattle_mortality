---
title: "fit_distributions"
author: "Marietta_Dalamanga"
date: "2024-07-14"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(tidyr)
library(survival)
library(survminer)
library(ggplot2)
library(ggpubr)
library(fitdistrplus)
library(logspline)
library(fitur)
library(actuar)
```



```{r}
data <- read.csv("./data/filtered_conditions_breeds.csv")
```


delete rows were the days alive is 0
```{r}
excluded_days <- data$days_alive <=1
excluded_days
data_excluded_days <- data[!excluded_days, ]
summary(data_excluded_days$days_alive)

```

Fit a linear model in the Kaplan-Meier survival estimates after we transform them(log(-log)) to conform with the equations of Weibull distribution.
```{r}
baseline_survival_days <- survfit(Surv(days_alive, status) ~ 1, data = data_excluded_days)
baseline_survival_days
summary(baseline_survival_days$surv)
surv <- baseline_survival_days$surv
summary(surv)
exclude_surv0 <- as.numeric(which(surv<1e-12))
surv[exclude_surv0]
new_surv <- surv[-exclude_surv0]
summary(new_surv)
time <-baseline_survival_days$time 
summary(time)
new_time <- time[-exclude_surv0]
summary(new_time)


log_log_s <- log(-log(new_surv))
log_t <- log(new_time)

summary(log_log_s)
summary(log_t)

baseline_survival_days_lm <- lm(log_log_s ~ log_t)
baseline_survival_days_lm %>%
  broom::augment() %>%
  ggplot(aes(x = log_t)) +
  geom_point(aes(y = log_log_s)) +
  geom_line(aes(y = .fitted), linetype = 2, color = "goldenrod") +
  theme_light()
```


```{r}
coef(baseline_survival_days_lm)
```


























